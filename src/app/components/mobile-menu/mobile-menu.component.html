<div class="mobile-menu">
  <div class="menu-toolbar">
    <button aria-label="Close menu" mat-icon-button (click)="closeMobileMenu('', '')">
      <mat-icon>menu</mat-icon>
    </button>
    <a routerLink='/' (click)="closeMobileMenu('HOME', '/')" class="logo">
      <img alt="Favorite icon" src="/assets/static_images/MTM_Favicon_4c_2.svg">
    </a>
    <button aria-label="Close menu" mat-icon-button class='close-button' (click)="closeMobileMenu('HOME', '/')">
      <mat-icon>close</mat-icon>
    </button>
  </div>
  <div class="auth-section" *ngIf='!loggedIn'>
    <button mat-flat-button color='primary' (click)='promptUserForAuth()'>REGISTER</button>
    <div class="sign-in-btn-wrapper">
      <small>Already have an account?</small>
      <button mat-flat-button class='sign-in-button' (click)='promptUserForAuth()'>SIGN IN</button>
    </div>
  </div>
  <div class="auth-section" *ngIf='loggedIn'>
    <button mat-flat-button color='primary' routerLink='/profile' (click)='closeMobileMenu("Profile", "/profile")'>MY
      ACCOUNT</button>

  </div>
  <mat-nav-list *ngIf='loggedIn' class='menu-list'>
    <ng-container *ngFor="let page of authenticatedPages">
      <mat-list-item class='page-item' mat-list-item [class.active]='page.active' (click)="handlePageClick(page)">
        {{page.name}}
        <mat-icon *ngIf='page.subPages'>{{page.toggled ? 'expand_less' : 'expand_more' }}</mat-icon>
      </mat-list-item>
      <mat-nav-list class='sub-list' *ngIf='page.subPages && page.toggled'>
        <mat-list-item *ngFor="let subPage of page.subPages; let last=last;" class='page-item' mat-list-item
          [class.active]='subPage.active' [routerLink]='subPage.route' [class.pushDown]='last'
          (click)="closeMobileMenu(subPage.name, subPage.route)">
          {{subPage.name}}
        </mat-list-item>
      </mat-nav-list>
    </ng-container>
  </mat-nav-list>
  <!-- <mat-list>
    <ng-container *ngFor="let item of items">
      <mat-list-item>{{item.name}}</mat-list-item>
      <mat-list style="margin-left:30px;">
        <div *ngFor="let subItem of item.subItems">
          <mat-list-item>{{ subItem.name }}</mat-list-item>
        </div>
      </mat-list>
    </ng-container>
  </mat-list> -->
  <div class="bottom-wrapper">
    <mat-nav-list class='menu-list'>
      <a *ngFor="let page of menuPages" class='page-item' mat-list-item [class.active]='page.active'
        [routerLink]='page.route' [fragment]="page.route === '/about' ? 'howitworks' : ''"
        (click)="closeMobileMenu(page.name, page.route)">
        {{page.name}}
      </a>
      <a *ngIf='loggedIn' class='page-item sign-out-item' mat-list-item (click)="signOut()">
        SIGN OUT
      </a>
    </mat-nav-list>
  </div>
</div>